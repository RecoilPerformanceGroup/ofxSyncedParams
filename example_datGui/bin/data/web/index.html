<html lang="en">
<head>
 	<meta charset=utf-8 />
 	<title>ofxLibwebsockets Echo Server test app</title>
 	<script type="text/javascript" src="js/libs/jquery-1.7.1.min.js"></script>
 	<script type="text/javascript" src="js/utils.js"></script>
 	<script type="text/javascript" src="js/main.js"></script>
 	<script src="js/libs/dat.gui.min.js" type="text/javascript"></script>
	<script src="js/libs/dat.color.min.js" type="text/javascript"></script>
	<script src="js/guiGlueMod.js" type="text/javascript"></script>
 	
</head>
<body>


<script>
	var optionsGUI = {};
	var params;

	$(document).ready( function() {
		setupSocket();
		
		setTimeout(function(){
			var myJson = {type:"initRequest"};	
			socket.send(JSON.stringify(myJson));
		}, 3000);
	});
	
	function initGui( val ){
		console.log("json -> gui:");

		var obj = JSON.parse(val);
		console.log(obj);

		if(obj["type"]=="update"){
			console.log("Update");
			var param = params;
			for(i=0;i<obj["path"].length;++i){
				param = param[obj["path"][i]];
			}
			// console.log(param);
			param[obj["name"]] = obj["value"];
		}else{
			console.log("Init");
			params = guiGlue(obj, optionsGUI);
		}
	};

	</script>

 <body>
	<div id="container">
		<h2>ofxLibwebsockets test applet</h2><hr />
		<div>
			<h3>Browser info</h3><hr />
			<div class="info">
				<strong>Detected Browser: <div id="brow">...</div></strong><br />
				<div id="status">Not initialized</div><br />
			</div>
		</div>
		<div>
			<h3>Input</h3>
			<hr />
			<input id="message" type="text" />
			<input id="button" type="button" value="send" />
		</div>
		<div>
			<h3>Messages</h3>
			<hr />
			<div id="messages" class="info"></div>
		</div>
	</div>
</body>
</html> 
